表结构的修改

1、表结构修改后，原来表中已存在的数据，就会出现结构混乱，makemigrations更新表的时候就会出错

比如第一次建模型，漏了一个字段，后来补上了。（经常遇到模型字段修改）

重新makemigrations，然后报错

数据库规则:除了新建表，如果你再次增加字段，数据库会有一些自动检测的东西（比如有没有默认值，是否允许为空）

如果表中已经有数据，这个字段还是非空的，且没有设定默认值，后台检测不通过就会报错。

解决方法（有两种）：

1、新增加的字段，设置允许为空。生成表的时候，之前数据新增加的字段就会为空。(null=True允许数据库中为空，blank=True允许admin后台中为空)

2、新增加的字段，设置一个默认值。生成表的时候，之前的数据新增加字段就会应用这个默认值（default=None,默认值为空）

删除0001_initial.py，再次makemigrations

接着再往数据库推送，python3 manage.py migrate

原来是自己在数据库手动添加过，不是通过django方式的。

于是手贱想删除表，删了再次执行，发现没有变化

删表有风险，可能误删其他表，如果表不多，所以还是新建一个库，环境干净（强迫症啊）

最后完美解决

以上就是本文的全部内容，希望对大家的学习有所帮助，也希望大家多多支持脚本之家。

