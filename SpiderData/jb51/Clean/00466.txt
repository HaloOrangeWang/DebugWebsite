问题描述

　　今天在Pycharm 中的Terminal下，执行数据迁移操作时，第一步： Python manage.py makemigrations ，是没有任何问题，但就是在执行真正的数据迁移时，也就是第二步：Python manage.py migrate 时，报错，错误截图如下

大概的意思就是   错误代码1091，原因是  “无法删除'dt_id'；请检查列/键是否存在”。

问题的解决

分析：

　　　　可能是数据库中的字段结构，已经完成了对此字段的修改，但是在执行数据迁移的时候，生成的某个日志文件（一般形如：0003_auto_20191011_2032.py），可能还有一些删除的字段

# Generated by Django 2.0.6 on 2019-10-11 12:32
from django.db import migrations, models
class Migration(migrations.Migration):
  dependencies = [
    ('modelapp', '0002_student'),
  ]
  operations = [
    migrations.RemoveField(
      model_name='student',
      name='age',
    ),
    migrations.RemoveField(
      model_name='student',
      name='birthday',
    ),
    migrations.RemoveField(
      model_name='student',
      name='salary',
    ),
    migrations.AlterField(
      model_name='student',
      name='tel',
      field=models.CharField(max_length=20),
    ),
  ]

如上图的红色字体问题部分，就是我们这个数据迁移时报错的原因，只要将红色字体部分注释掉即可

# Generated by Django 2.0.6 on 2019-10-11 12:32
from django.db import migrations, models
class Migration(migrations.Migration):
  dependencies = [
    ('modelapp', '0002_student'),
  ]
  operations = [
    # migrations.RemoveField(
    #   model_name='student',
    #   name='age',
    # ),
    # migrations.RemoveField(
    #   model_name='student',
    #   name='birthday',
    # ),
    # migrations.RemoveField(
    #   model_name='student',
    #   name='salary',
    # ),
    migrations.AlterField(
      model_name='student',
      name='tel',
      field=models.CharField(max_length=20),
    ),
  ]

然后我们再次执行 Python manage.py migrate  的时候就能成功迁移数据了。

总结

以上所述是小编给大家介绍的执行Django数据迁移时报 1091错误及解决方法,希望对大家有所帮助，如果大家有任何疑问请给我留言，小编会及时回复大家的。在此也非常感谢大家对脚本之家网站的支持！

如果你觉得本文对你有帮助，欢迎转载，烦请注明出处，谢谢！

