使用指令：pyinstaller -F -w main.py


生成的.exe文件执行报错

看报错信息，初步怀疑是生成的.exe不能执行.ini配置文件。

将程序需要的.ini文件放到.exe同级目录下，虽然还是执行不成功，但是没有上述报错了；删除同级目录下面的.ini文件，上述报错仍然存在，说明初步的判定成立，.exe执行不成功与.ini配置文件有关系。


测试办法

pyinstaller不加参数”-F"和“-w"，执行执行指令：pyinstaller main.py

加不加“-F"和”-w"效果的详细说明文章链接：https://www.jb51.net/article/183469.htm


命令行窗口显示报错信息如下

dist目录下并没有.ini配置文件，手动添加该文件，再运行main.exe程序，


新的报错如下

上述报错说模块openpyxl执行load_workbook打开文件功能时报错，但是在pycharm环境下运行main.py程序是ok的，不明白为什么生成.exe之后就无法打开.xlsx文件。

尝试了好几个.xlsx文件都这样，怀疑是不是生成的.exe不能打开电脑加密的.xlsx文件？

在电脑上新建一个.xlsx文件，不对文件进行任何操作，使其处于未被加密状态，执行.exe程序，和打开加密的.exe文件报错对比如下，发现生成的.exe确实不能打开加密的文件：


上述报错信息解释如下

最上面的红框框出来的报错是打开的加密文件，可以看出来执行到代码的30行load_workbook打开文件操作；

下面的红框框出来的报错是打开的没有加密文件，可以看出来执行到代码的35行了，这个时候30行的load_workbook打开文件操作执行ok通过了，是其他原因导致的报错；

说明：生成的.exe确实不能打开加密的文件。

将文件解密后，.exe功能执行ok。

同样用解密的文件，使用指令：pyinstaller -F -w main.py 生成的.exe程序，即使放置了需要的.ini配置文件执行结果也不是想要的（只显示一个界面，点击确认button后应该弹出另外一个数据展示界面），但是不会报错。原因未知。

使用"-n"指定生成的.exe的名称，指令：pyinstaller main.py. -n ***

由于.exe实现的界面功能比较简单，没有在程序里面设置日志功能，当遇到操作不当引起bug时还是需要借助命令行窗口的显示查找原因的，所以不使用"-w"参数取消显示命令行窗口了。


附上pyinstaller的常见参数

以上为个人经验，希望能给大家一个参考，也希望大家多多支持脚本之家。

