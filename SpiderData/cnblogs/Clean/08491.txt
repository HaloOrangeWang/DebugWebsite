
前言

最近学习flask表单的时候，碰到了一个问题，看着教程百思不得其解，所以查阅了一些资料的终于把这个困扰了我两个晚上的问题解决了。


问题详情

在教程中的是这样写的：

但是这样写之后，却发现报错了：

作为小白的我看的是一脸懵逼啊。完全不知道出了什么问题。翻译了一下大致的意思就是你需要一个活动的HTTP请求，可是我该怎么办呢。

然后我又尝试了一种办法，把上面这个问题我们记为问题1吧

但是又报错了。

RuntimeError: Working outside of application context.

意思就是没有在应用的上下文中。到这里我已经不知道怎么办了。。欲哭无泪，但是我们还是把这个问题记为问题2吧，总归是要解决的


解决问题

但是我没有放弃尝试和查找资料该如何解决，经过我2天下班后的不断折腾，终于在一个论坛中看见了一个和我一样的问题。

并且看到了其中一个回复：

看到后觉得如获至宝，就立马去flask shell中尝试了一下：

多谢这位大佬的指点，那么问题1到这里就算是解决了。但是问题2还没有解决，为此我决定去看看这个上下文的东西。

终于解决了困扰了2天的问题：


问题总结


问题1

首先在问题1中我们使用了flask shell的方式进入shell，根据教程中的解释，在使用flask shell的时候自动会进入应用上下文情境。但是我们创建forms表单，没有使用的app.test_request_context():进入请求的上下文情境，所以导致运行报错没有活动的HTTP请求。因为初始化就没有在请求的情境中。


问题2

第二次我没有使用flask shell的方式进入shell，然后运行报错set up an application context with app.app_context()，因为我进入的是python的shell并没有进入flask的shell，所以报错了。然后我们根据查的资料的手动推送一下应用的上下文情境，然后在进行请求的情境，这样我们的代码执行就没有错误了。至于为什么不用 with app.app_context() ，因为在with语句外面，我们这个情境已经被释放了。所以运行就会继续报第二个问题的错误了。除非我们全部在with语句中的进行操作，但是这是不太现实的，所以需要手动的去调节。


后记

经过这么一番的折腾，总结学东西还是要多查资料，多坚持一会，也许今天困扰你的东西，明天就豁然开朗了。

