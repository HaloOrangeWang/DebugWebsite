
Github项目链接：

https://github.com/Pineapple666/TaobaoSpider


一、问题描述

我一开始写爬虫的时候，数据用的是Linux虚拟机的mysql5.1上储存的（可以看做是服务器），后来又换了win10本地的mysql8.0。结果出现了如下问题：

问题1：在Navicat中建表时，设置的int字段长度为10，可一保存就自动变成了0。

问题2：运行程序后，出现如下错误。


二、问题分析


问题1

在Navicat中建表时，设置的int字段长度为10，可一保存就自动变成了0。

查了一下资料发现，从8.0.17版本开始，TINYINT, SMALLINT, MEDIUMINT, INT, and BIGINT类型的显示宽度将失效，但这并不是导致程序出错的原因。


问题2

第一行的comments，不正确的整数值？可能是我插入是数据有问题。将两个版本的表比对一下：

mysql5.1：

查了下相关资料，发现mysql高版本在插入null值时会报错，要将值替换成NULL或0。


5.1版本测试：


建表语句：


测试代码：


执行结果：

没有报错，空值自动转换为0


8.0版本测试：


建表语句同上


测试代码：


执行结果：

报错(1366, "Incorrect integer value: '' for column 'brith' at row 1")，插入数据失败。


修改代码：


执行结果：

没有报错，正确插入NULL和0


三、解决方法

修改MySQL类的insert方法

我没有加判断mysql版本的操作，反正空值都是要转换成0的，干脆统一一下，不管是什么版本，都判断是否有空值，有则替换成0


代码


执行结果：

没有报错，成功插入空值

